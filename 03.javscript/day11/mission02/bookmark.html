<!-- TODO í•´ì‹œíƒœê·¸ # ê°œì„  í•„ìš” -->
<!-- TODO ìš°ì™€ ë‚˜í˜„ë‹˜ í…ŒìŠ¤íŠ¸ ì½”ë“œ ëŒ€ë°•! -->
<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <title>Tag Bookmark</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <header class="bar">
      <h1>Tag Notes (Lite)</h1>
      <div style="display: flex; gap: 8px">
        <button type="button" id="theme-btn">ðŸŒ“</button>
      </div>
    </header>

    <section class="controls">
      <form id="add-form" autocomplete="off">
        <input id="title" placeholder="ì œëª©" required />
        <input id="url" placeholder="ë§í¬(URL) ë˜ëŠ” ë©”ëª¨" />
        <input id="tags" placeholder="íƒœê·¸(ì‰¼í‘œë¡œ êµ¬ë¶„)" />
        <button type="submit">ì¶”ê°€</button>
      </form>

      <div class="filters">
        <input id="q" placeholder="ê²€ìƒ‰(ì œëª©/íƒœê·¸) â€” 300ms ë””ë°”ìš´ìŠ¤" />
        <select id="sort">
          <option value="recent">ì •ë ¬: ìµœì‹ </option>
          <option value="title">ì •ë ¬: ì œëª©</option>
          <option value="tags">ì •ë ¬: íƒœê·¸ìˆ˜</option>
        </select>
        <button type="button" id="clear-filters">í•„í„° ì´ˆê¸°í™”</button>
      </div>
    </section>

    <section class="grid" id="list"></section>
    <aside class="stats" id="stats"></aside>
    <div id="toast-root"></div>

    <script type="module">
      import { store } from './store.js';
      import { THEME_KEY } from './constants.js';
      import { themeBtnEl, qInputEl, sortEl } from './utils/dom.js';
      import { sarchFilter, sortFilter, tagFilter, clearFilter } from './utils/filter/filter.js';
      import { createCardsRenderer } from './render/renderCards.js';
      import { addItem } from './actions/addItem.js';
      import { deleteItem } from './actions/deleteItem.js';

      // ìƒˆë¡œê³ ì¹¨ í•„í„° ìœ ì§€ ==================================
      (() => {
        const state = store.get() ?? {};
        const { q, sort, selected } = state.filter ?? INITIAL_STATE.filter;
        if (qInputEl) qInputEl.value = q;
        if (sortEl) sortEl.value = sort;
        const saved = localStorage.getItem(THEME_KEY);
        document.body.classList.toggle(THEME_KEY, saved === '1');
      })();

      // ìƒì„± ë° êµ¬ë… ==================================
      const render = createCardsRenderer();
      store.subscribe(render);

      // ì´ë²¤íŠ¸ ë“±ë¡ ==================================
      themeBtnEl.addEventListener('click', () => {
        const isLight = document.body.classList.toggle(THEME_KEY);
        localStorage.setItem(THEME_KEY, isLight ? '1' : '0');
      });
      addItem();
      deleteItem();
      sarchFilter(); // ê²€ìƒ‰
      sortFilter(); // ì •ë ¬
      tagFilter();
      clearFilter();

      render(store.get());
    </script>
  </body>
</html>
