<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>íšŒì›ê°€ì…_2-1</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      main {
        padding: 30px;
      }

      .form-container {
        margin: 0 auto;
        padding: 20px;
        width: 350px;
        min-width: 350px;
        border: 1px solid #f0f0f0;
      }

      .form-container fieldset {
        margin-bottom: 10px;
        border: none;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .form-container legend {
        margin-bottom: 10px;
      }

      .form-container input,
      .form-container button,
      .form-container #error {
        padding: 5px;
        width: 100%;
        border: 1px solid #bebebe;
      }

      .form-container #error {
        background-color: rgb(239, 239, 239);
        display: none;
      }

      .form-container #user-count {
        min-height: 20px;
        color: #8c8c98;
        text-align: center;
        font-size: 1rem;
        font-weight: 700;
      }
    </style>
  </head>
  <body>
    <main>
      <div class="form-container">
        <form>
          <fieldset>
            <legend>ğŸ‘¤ ì‚¬ìš©ì ìƒì„±</legend>
            <input type="text" id="userName" placeholder="ì´ë¦„" />
            <input type="password" id="userPassword" placeholder="ë¹„ë°€ë²ˆí˜¸" />
            <button type="button" onclick="createUser()">ì‚¬ìš©ì ë§Œë“¤ê¸°</button>
          </fieldset>

          <fieldset>
            <legend>ğŸ” ë¹„ë°€ë²ˆí˜¸ í™•ì¸</legend>
            <input type="password" id="confirm-password" placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸" />
            <button type="button" onclick="checkPassword()">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</button>
          </fieldset>

          <fieldset>
            <legend>ğŸ“Š ì „ì²´ ì‚¬ìš©ì ìˆ˜ í™•ì¸</legend>
            <p id="user-count">í˜„ì¬ ì‚¬ìš©ì ìˆ˜</p>
            <button type="button" onclick="showUserCount()">í˜„ì¬ ìƒì„±ëœ ì‚¬ìš©ì ìˆ˜ ë³´ê¸°</button>
          </fieldset>

          <p id="error"></p>
        </form>
      </div>
    </main>

    <script>
      const ERRORS = {
        NO_NAME: 'âŒ ì´ë¦„ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.',
        NO_PASSWORD: 'âŒ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.',
        NO_NAME_AND_PASSWORD: 'âŒ ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”.',
        NO_CURRENT_USER: 'âŒ ë¨¼ì € ì‚¬ìš©ìë¥¼ ìƒì„±í•˜ì„¸ìš”.',
        NO_INPUT_PASSWORD: 'âŒ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.',
        PASSWORD_VALIDITY: 'âŒ ë¹„ë°€ë²ˆí˜¸ëŠ” 6ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.',
        PASSWORD_MISMATCH: 'âŒ ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë¦½ë‹ˆë‹¤.',
      };

      class User {
        static count = 0;
        static currentUser = null; // getterë¥¼ í†µí•´ ê°€ê³µëœ ìœ ì € ì •ë³´ ì €ì¥ìš©

        #password = '';
        _name = '';

        constructor(name, password) {
          this.name = name;
          this.#password = password;
          User.count++;
        }

        set name(value) {
          if (value.length < 2) throw new Error('ì´ë¦„ì€ ë‘ ê¸€ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
          this._name = value; // this.name ì´ë©´ setterë¥¼ ë‹¤ì‹œ í˜¸ì¶œí•´ì„œ ë¬´í•œë£¨í”„ê°€ ë°œìƒí•  ìˆ˜ ìˆìŒ
        }

        get name() {
          return this._name.toUpperCase();
        }

        // staticì´ ì•„ë‹Œ ì´ìœ  - #passwordë¼ì„œ í´ë˜ìŠ¤ ì „ì²´(static)ì—ì„œëŠ” ì ‘ê·¼í•  ìˆ˜ ì—†ìŒ
        checkPassword(inputPassword) {
          return this.#password === inputPassword;
        }

        static getCount() {
          return this.count;
        }
      }

      // ========== ë©”ì‹œì§€ ì¶œë ¥ í•¨ìˆ˜ ==========
      function showMessage(msg, isError = true) {
        const msgBox = document.getElementById('error');
        msgBox.textContent = msg;
        msgBox.style.color = isError ? 'red' : 'green';
        msgBox.style.display = msg ? 'block' : 'none';
      }

      // ========== ìœ ì € ìƒì„± í•¨ìˆ˜ ==========
      function createUser() {
        const name = document.getElementById('userName').value.trim();
        const password = document.getElementById('userPassword').value;

        if (!name) return showMessage(ERRORS.NO_NAME);
        if (!password) return showMessage(ERRORS.NO_PASSWORD);
        if (!name && !password) return showMessage(ERRORS.NO_NAME_AND_PASSWORD);
        if (password.length < 6) return showMessage(ERRORS.PASSWORD_VALIDITY);

        try {
          User.currentUser = new User(name, password);
          showMessage(`âœ… ì‚¬ìš©ì ${User.currentUser.name} ìƒì„± ì™„ë£Œ!`, false);
        } catch (err) {
          showMessage(`âŒ ${err.message}`);
        }
      }

      // ========== ë¹„ë°€ë²ˆí˜¸ í™•ì¸ í•¨ìˆ˜ ==========
      function checkPassword() {
        const inputPw = document.getElementById('confirm-password').value;

        if (!inputPw) return showMessage(ERRORS.NO_INPUT_PASSWORD);
        if (!User.currentUser) return showMessage(ERRORS.NO_CURRENT_USER);

        const isMatch = User.currentUser.checkPassword(inputPw);
        showMessage(isMatch ? 'âœ… ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤!' : ERRORS.PASSWORD_MISMATCH, !isMatch);
      }

      // ========== ìƒì„±ëœ ìœ ì € í™•ì¸ í•¨ìˆ˜ ==========
      function showUserCount() {
        const count = User.getCount();
        document.getElementById('user-count').textContent = `í˜„ì¬ ì‚¬ìš©ì ìˆ˜: ${count}ëª…`;
      }
    </script>
  </body>
</html>
