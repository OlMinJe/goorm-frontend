<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì£¼ìŠ¤ ë§Œë“¤ê¸° (class)</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        padding: 30px;
        font-family: sans-serif;
      }

      ul,
      li {
        list-style: none;
      }

      .dropdown-container {
        position: relative;
        display: inline-block;
        margin-right: 30px;
      }

      .dropdown-container button {
        padding: 10px;
        cursor: pointer;
      }

      .dropdown-menu {
        position: absolute;
        top: 100%;
        left: 0;
        padding: 10px;
        background-color: antiquewhite;
        display: none;
        z-index: 1000;
      }

      .dropdown-menu li {
        cursor: pointer;
      }

      .dropdown-menu.show {
        display: block;
      }

      #result {
        margin-top: 30px;
        font-size: 1.2rem;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <main>
      <div class="dropdown-container">
        <button id="fruitBtn">ê³¼ì¼ ì„ íƒ</button>
        <span id="selectedFruit"></span>
        <ul class="dropdown-menu" id="fruitMenu">
          <li>ì‚¬ê³¼</li>
          <li>í¬ë„</li>
          <li>ì˜¤ë Œì§€</li>
        </ul>
      </div>

      <div class="dropdown-container">
        <button id="drinkBtn">ìŒë£Œ ì„ íƒ</button>
        <span id="selectedDrink"></span>
        <ul class="dropdown-menu" id="drinkMenu">
          <li>ìš°ìœ </li>
          <li>ì‚¬ì´ë‹¤</li>
          <li>ì»¤í”¼</li>
        </ul>
      </div>

      <div id="result">ì£¼ìŠ¤ ë§Œë“¤ê¸°!</div>
      <ul id="log"></ul>
    </main>

    <script>
      class Dropdown {
        // dom elementì˜ ì—¬ë¶€ í™•ì¸ í•¨ìˆ˜
        static get(id) {
          const el = document.getElementById(id);
          if (!el) throw new Error(`${id} ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);
          return el;
        }

        // ìƒì„±ì
        constructor(dropdownBtn, menu, onSelect) {
          this.button = Dropdown.get(dropdownBtn); // í† ê¸€ ë²„íŠ¼
          this.menu = Dropdown.get(menu); // ë©”ë‰´ ë¦¬ìŠ¤íŠ¸
          this.onSelect = onSelect; // ë©”ë‰´ ì„ íƒ ì´ë²¤íŠ¸ ì½œë°± í•¨ìˆ˜(ë‹¤ë¥¸ í•¨ìˆ˜ì—ê²Œ ì¸ìë¡œ ì „ë‹¬ -> íŠ¹ì • ì‹œì ì— í˜¸ì¶œí•˜ê¸° ìœ„í•œ í•¨ìˆ˜)
          this.bindEvents(); // ì´ˆê¸° ì‹¤í–‰ìœ¼ë¡œ í•„ìš”í•œê±° ë“±ë¡í•˜ê¸°
        }

        // ì´ˆê¸° ì‹¤í–‰ ë“±ë¡
        bindEvents() {
          // í† ê¸€ ì´ë²¤íŠ¸ ë“±ë¡í•˜ê¸°
          this.button.addEventListener('click', () => this.toggleMenu());

          /** ë©”ë‰´ ì„ íƒ ì´ë²¤íŠ¸ ë“±ë¡í•˜ê¸°
           * - ì½˜ì†”ë¡œ this.menu.querySelectorAll('li') ì¶œë ¥í–ˆë”ë‹ˆ NodeListë¡œ ë‚˜ì˜´
           * => NodeListëŠ” ì°ë°°ì—´ì€ ì•„ë‹ˆë¼ê³  ì•Œê³  ìˆìŒ
           * => ë°°ì—´ ë©”ì„œë“œë¥¼ ì§­ë°°ì—´ì— ì‚¬ìš©í•˜ë©´ ìœ„í—˜í•˜ì§€ ì•Šì„ê¹Œ ìƒê°í•˜ì—¬, ë°°ì—´ë¡œ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•¨
           */
          [...this.menu.querySelectorAll('li')].forEach((item) => {
            // ë©”ë‰´ ì„ íƒ ì‹œì— ë™ì‘í•  ì´ë²¤íŠ¸
            item.addEventListener('click', () => {
              this.menu.classList.remove('show');
              this.onSelect?.(item.textContent);
            });
          });
        }

        // í† ê¸€ ì´ë²¤íŠ¸
        toggleMenu() {
          this.menu.classList.toggle('show');
        }
      }

      class JuiceMaker {
        static TYPES = ['fruit', 'drink'];

        constructor(resultId) {
          this.result = Dropdown.get(resultId);
          this.log = Dropdown.get('log');
          this.selected = { fruit: '', drink: '' };
          this.selectedLabels = {
            fruit: Dropdown.get('selectedFruit'),
            drink: Dropdown.get('selectedDrink'),
          };
        }

        setItem(type, value) {
          if (!JuiceMaker.TYPES.includes(type)) throw new Error('"fruit" ë˜ëŠ” "drink"ë§Œ í—ˆìš©ë©ë‹ˆë‹¤.');

          this.selected[type] = value;
          this.selectedLabels[type].textContent = value;
          this.updateResult();
        }

        updateResult() {
          const { fruit, drink } = this.selected;

          if (fruit && drink) {
            const makerResult = `${fruit}${drink}`;
            this.result.textContent = `ğŸ¥¤ ${makerResult} ì™„ì„±!`;
            this.addLog(makerResult);
            // ì´ˆê¸°í™”
            this.selected = { fruit: '', drink: '' };
            this.selectedLabels.fruit.textContent = '';
            this.selectedLabels.drink.textContent = '';
          } else {
            this.result.textContent = 'ì£¼ìŠ¤ ë§Œë“¤ê¸°!';
          }
        }

        addLog(makerResult) {
          const li = document.createElement('li');
          li.textContent = `âœ… ${makerResult}`;
          this.log.appendChild(li);
        }
      }

      const juiceMaker = new JuiceMaker('result');

      new Dropdown('fruitBtn', 'fruitMenu', (value) => juiceMaker.setItem('fruit', value));
      new Dropdown('drinkBtn', 'drinkMenu', (value) => juiceMaker.setItem('drink', value));
    </script>
  </body>
</html>
